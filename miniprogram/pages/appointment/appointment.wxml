<view class="container">
  <!-- 使用 @lspriv/wx-calendar 组件 -->
  <calendar 
    id="calendar"
    mode="{{calendarMode}}"
    date="{{selectedDate}}"
    marks="{{markedDates}}"
    lunar="{{showLunar}}"
    plugins="{{plugins}}"
    header="{{true}}"
    fold="{{false}}"
    bindload="onCalendarLoad"
    bindclick="onCalendarSelect"
    bindchange="onCalendarChange"
    bindviewchange="onViewChange"
  />

  <!-- 农历显示控制 -->
  <view class="lunar-control">
    <view class="lunar-toggle" bindtap="toggleLunar">
      <text>{{showLunar ? '隐藏农历' : '显示农历'}}</text>
    </view>
  </view>

  <!-- 今日预约 -->
  <view class="today-appointments">
    <view class="section-title">{{selectedDateDisplay}} 预约</view>

    <block wx:if="{{todayAppointments.length > 0}}">
      <view class="meal-card" wx:for="{{todayAppointments}}" wx:key="id">
        <view class="meal-header">
          <view class="meal-type">{{item.mealType}}</view>
          <view class="meal-actions">
            <view class="action-btn edit" bindtap="editAppointment" data-id="{{item.id}}">修改</view>
            <view class="action-btn delete" bindtap="deleteAppointment" data-id="{{item.id}}">删除</view>
          </view>
        </view>
        <view class="dishes-list">
          <view class="dish-item" wx:for="{{item.dishList}}" wx:key="id" wx:for-item="dish">
            <image class="dish-image" src="{{dish.images[0] || '/images/default-dish.png'}}"></image>
            <view class="dish-name">{{dish.name}}</view>
          </view>
        </view>
      </view>
    </block>

    <view class="empty-tip" wx:else>
      <view class="empty-text">暂无预约，请添加</view>
    </view>
  </view>

  <!-- 添加预约按钮 -->
  <view class="add-btn" bindtap="addAppointment">+</view>
</view> 