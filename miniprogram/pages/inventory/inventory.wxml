<view class="container" style="padding-bottom: {{safeAreaBottom ? (safeAreaBottom + 4 + 'px') : '85rpx'}};">
  <!-- æœç´¢åŒºåŸŸ -->
  <view class="search-bar">
    <view class="search-box">
      <input 
        class="search-input" 
        placeholder="æœç´¢é£Ÿæ" 
        value="{{searchKeyword}}" 
        bindinput="onSearchInput" 
        confirm-type="search"
      />
      <view class="search-icon">ğŸ”</view>
    </view>
  </view>

  <!-- ç­›é€‰ç»„ä»¶ -->
  <view class="filter-bar">
    <view 
      class="filter-item {{filterStatus === '' ? 'active' : ''}}" 
      bindtap="filterByStatus" 
      data-status=""
    >
      <text>å…¨éƒ¨</text>
      <text class="count">{{totalCount}}</text>
    </view>
    <view 
      class="filter-item {{filterStatus === 'normal' ? 'active' : ''}}" 
      bindtap="filterByStatus" 
      data-status="normal"
    >
      <text>æœªåˆ°æœŸ</text>
      <text class="count">{{normalCount}}</text>
    </view>
    <view 
      class="filter-item {{filterStatus === 'expiring' ? 'active' : ''}}" 
      bindtap="filterByStatus" 
      data-status="expiring"
    >
      <text>å³å°†è¿‡æœŸ</text>
      <text class="count">{{expiringCount}}</text>
    </view>
    <view 
      class="filter-item {{filterStatus === 'expired' ? 'active' : ''}}" 
      bindtap="filterByStatus" 
      data-status="expired"
    >
      <text>å·²è¿‡æœŸ</text>
      <text class="count">{{expiredCount}}</text>
    </view>
  </view>

  <!-- åº“å­˜åˆ—è¡¨ï¼ˆæ»šåŠ¨åŒºåŸŸï¼‰ -->
  <view class="inventory-scroll-container">
    <scroll-view 
      class="inventory-list" 
      scroll-y 
      enable-back-to-top
      refresher-enabled
      refresher-threshold="50"
      refresher-default-style="black"
      refresher-background="#f6f6f6"
      refresher-triggered="{{isRefreshing}}"
      bindrefresherrefresh="onRefresh"
      bindscrolltolower="onReachBottom"
      enhanced="{{true}}"
      show-scrollbar="{{true}}"
      fast-deceleration="{{true}}"
      scroll-anchoring="{{true}}"
      style="--webkit-scrollbar-offset-right: 8rpx; padding-right: 10rpx;"
    >
      <!-- åŠ è½½çŠ¶æ€ -->
      <view class="loading-container" wx:if="{{loading && items.length === 0}}">
        <view class="loading-spinner"></view>
        <view class="loading-text">åŠ è½½ä¸­...</view>
      </view>

      <!-- åˆ—è¡¨å†…å®¹ -->
      <block wx:if="{{items.length > 0}}">
        <view 
          class="inventory-item"
          wx:for="{{items}}" 
          wx:key="id" 
          bindtap="editItem" 
          data-id="{{item.id}}"
        >
          <!-- å·¦ä¾§å›¾ç‰‡åŒºåŸŸ -->
          <view class="item-image">
            <image src="{{item.image || '/images/default-food.png'}}" mode="aspectFill"></image>
          </view>
          
          <!-- ä¸­é—´é£Ÿæä¿¡æ¯åŒºåŸŸ -->
          <view class="item-info">
            <view class="item-name">{{item.name}}</view>
            <view class="item-amount">{{item.amount}}</view>
          </view>
          
          <!-- å³ä¾§æ—¥æœŸä¿¡æ¯åŒºåŸŸ -->
          <view class="item-dates-container">
            <view class="date-row put-in-date">
              <text class="date-label">æ”¾å…¥:</text>
              <text class="date-value">{{item.putInDate}}</text>
            </view>
            <view class="date-row expiry-date">
              <text class="date-label">åˆ°æœŸ:</text>
              <text class="date-value {{item.isExpired ? 'expired' : item.isExpiringSoon ? 'expiring-soon' : ''}}">{{item.expiryDate}}</text>
            </view>
            <view class="days-left {{item.isExpired ? 'expired' : item.isExpiringSoon ? 'expiring-soon' : ''}}" wx:if="{{item.daysLeft !== null}}">
              {{item.isExpired ? 'å·²è¿‡æœŸ' : 'å‰©' + item.daysLeft + 'å¤©'}}
            </view>
          </view>
          
          <!-- åˆ é™¤æŒ‰é’® -->
          <view class="delete-btn-container">
            <view class="delete-btn" catchtap="deleteItem" data-id="{{item.id}}">Ã—</view>
          </view>
        </view>

        <!-- åº•éƒ¨åŠ è½½æ›´å¤šæç¤º -->
        <view class="load-more-tip" wx:if="{{isLoadingMore}}">
          <view class="loading-spinner small"></view>
          <text class="loading-text">åŠ è½½æ›´å¤š...</text>
        </view>
        
        <!-- åº•éƒ¨æ— æ›´å¤šæ•°æ®æç¤º -->
        <view class="no-more-tip" wx:if="{{!isLoadingMore && !hasMore && filteredTotal > pageSize}}">
          <text>æ²¡æœ‰æ›´å¤šäº†</text>
        </view>
      </block>
      <view class="empty-tip" wx:elif="{{!loading}}">
        <view class="empty-text">æš‚æ— åº“å­˜ï¼Œè¯·æ·»åŠ </view>
      </view>
    </scroll-view>
  </view>

  <!-- æ·»åŠ æŒ‰é’® -->
  <view class="add-btn" bindtap="addItem" style="bottom: calc(120rpx + {{safeAreaBottom ? (safeAreaBottom + 48 + 'px') : '0'}});">+</view>
</view> 